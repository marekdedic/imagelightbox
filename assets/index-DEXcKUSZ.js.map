{"version":3,"file":"index-DEXcKUSZ.js","sources":["../../src/lib/query.ts","../../src/lib/TransitionDirection.ts","../../src/lib/history.ts","../../src/lib/container.ts","../../src/lib/activity-indicator.ts","../../src/lib/arrows.ts","../../src/lib/caption.ts","../../src/lib/close-button.ts","../../src/lib/fullscreen.ts","../../src/lib/fullscreen-button.ts","../../src/lib/ImageView.ts","../../src/lib/keyboard-navigation.ts","../../src/lib/navigation.ts","../../src/lib/PreloadedVideo.ts","../../src/lib/VideoCache.ts","../../src/lib/State.ts","../../src/lib/imagelightbox.ts","../../src/index.ts"],"sourcesContent":["export function addQueryField(\n  query: string,\n  key: string,\n  value: string,\n): string {\n  const newField = `${key}=${value}`;\n  let newQuery = `?${newField}`;\n\n  if (query) {\n    const keyRegex = new RegExp(`([?&])${key}=[^&]*`);\n    if (keyRegex.exec(query) !== null) {\n      newQuery = query.replace(keyRegex, `$1${newField}`);\n    } else {\n      newQuery = `${query}&${newField}`;\n    }\n  }\n  return newQuery;\n}\n\nexport function getQueryField(key: string): string | undefined {\n  const keyValuePair = new RegExp(`[?&]${key}(=([^&#]*)|&|#|$)`).exec(\n    document.location.search,\n  );\n  if (keyValuePair?.[2] === undefined) {\n    return undefined;\n  }\n  return decodeURIComponent(keyValuePair[2].replace(/\\+/g, \" \"));\n}\n\nexport function removeQueryField(query: string, key: string): string {\n  let newQuery = query;\n  if (newQuery) {\n    const keyRegex1 = new RegExp(`\\\\?${key}=[^&]*`);\n    const keyRegex2 = new RegExp(`&${key}=[^&]*`);\n    newQuery = newQuery.replace(keyRegex1, \"?\");\n    newQuery = newQuery.replace(keyRegex2, \"\");\n  }\n  return newQuery;\n}\n","export const enum TransitionDirection {\n  Right = -1,\n  None = 0,\n  Left = 1,\n}\n","import { addQueryField, getQueryField, removeQueryField } from \"./query\";\nimport { TransitionDirection } from \"./TransitionDirection\";\n\ninterface HistoryState {\n  imageLightboxIndex?: string;\n  imageLightboxSet?: string;\n}\n\nexport function openHistory(\n  set: string | undefined,\n  images: Array<HTMLAnchorElement>,\n  open: (index: number, skipHistory?: boolean) => void,\n): void {\n  if (getQueryField(\"imageLightboxSet\") !== set) {\n    return;\n  }\n  const id = getQueryField(\"imageLightboxIndex\");\n  if (id === undefined) {\n    return;\n  }\n  let newIndex = images.findIndex((image) => image.dataset[\"ilb2Id\"] === id);\n  if (newIndex < 0) {\n    newIndex = parseInt(id, 10);\n  }\n  open(newIndex, true);\n}\n\nexport function popHistory(\n  event: PopStateEvent,\n  set: string | undefined,\n  images: Array<HTMLAnchorElement>,\n  currentIndex: number | null,\n  open: (index: number, skipHistory?: boolean) => void,\n  close: (skipHistory?: boolean) => void,\n  change: (\n    index: number,\n    transitionDirection: TransitionDirection,\n    skipHistory?: boolean,\n  ) => void,\n): void {\n  const historyState = event.state as\n    | HistoryState\n    | Record<string, never>\n    | null\n    | undefined;\n  // This needs to be before checking the set in order to close the lightbox when navigating to a non-imagelightbox state\n  if (!historyState || Object.keys(historyState).length === 0) {\n    close(true);\n    return;\n  }\n  if (historyState.imageLightboxSet !== set) {\n    return;\n  }\n  const newId = historyState.imageLightboxIndex;\n  if (newId === undefined) {\n    close(true);\n    return;\n  }\n  let newIndex = images.findIndex(\n    (e: HTMLElement) => e.dataset[\"ilb2Id\"] === newId,\n  );\n  if (newIndex < 0) {\n    newIndex = parseInt(newId, 10);\n  }\n  if (currentIndex === null) {\n    open(newIndex, true);\n    return;\n  }\n  change(\n    newIndex,\n    newIndex > currentIndex\n      ? TransitionDirection.Right\n      : TransitionDirection.Left,\n    true,\n  );\n}\n\nexport function pushQuitToHistory(): void {\n  let newQuery = removeQueryField(\n    document.location.search,\n    \"imageLightboxIndex\",\n  );\n  newQuery = removeQueryField(newQuery, \"imageLightboxSet\");\n  window.history.pushState({}, \"\", document.location.pathname + newQuery);\n}\n\nexport function pushToHistory(\n  index: number,\n  set: string | undefined,\n  images: Array<HTMLAnchorElement>,\n): void {\n  const newIndex = images[index].dataset[\"ilb2Id\"] ?? index.toString();\n  let newQuery = addQueryField(\n    document.location.search,\n    \"imageLightboxIndex\",\n    newIndex,\n  );\n  const newHistoryState: HistoryState = {\n    imageLightboxIndex: newIndex,\n    imageLightboxSet: \"\",\n  };\n  if (set !== undefined) {\n    newHistoryState.imageLightboxSet = set;\n    newQuery = addQueryField(newQuery, \"imageLightboxSet\", set);\n  }\n  window.history.pushState(\n    newHistoryState,\n    \"\",\n    document.location.pathname + newQuery,\n  );\n}\n","import \"./container.css\";\n\nconst container = document.createElement(\"dialog\");\ncontainer.setAttribute(\"id\", \"ilb-container\");\ndocument.body.appendChild(container);\n\nlet wrappedOnclick: ((e: Event) => void) | null = null;\n\nexport function addContainerToDOM(\n  animationSpeed: number,\n  attachOnclick: boolean,\n  onclick: () => void,\n): void {\n  container.classList.remove(\"ilb-overlay\");\n  document.body.classList.add(\"ilb-body\");\n  container.showModal();\n  if (attachOnclick) {\n    wrappedOnclick = (e): void => {\n      e.stopPropagation();\n      onclick();\n    };\n    container.addEventListener(\"click\", wrappedOnclick);\n    container.addEventListener(\"touchend\", wrappedOnclick);\n  }\n  container.style.transition = `opacity ${animationSpeed.toString()}ms ease`;\n  setTimeout(() => {\n    container.style.opacity = \"1\";\n  }, 50);\n}\n\nexport function darkenOverlay(): void {\n  container.classList.add(\"ilb-overlay\");\n}\n\nexport function getContainer(): HTMLDialogElement {\n  return container;\n}\n\nexport function removeContainerFromDOM(): void {\n  if (wrappedOnclick !== null) {\n    container.removeEventListener(\"click\", wrappedOnclick);\n    container.removeEventListener(\"touchend\", wrappedOnclick);\n  }\n  container.close();\n  container.textContent = \"\";\n  document.body.classList.remove(\"ilb-body\");\n}\n\nexport function transitionOutContainer(): void {\n  container.style.opacity = \"0\";\n}\n","import \"./activity-indicator.css\";\nimport { getContainer } from \"./container\";\n\nconst activityIndicator = document.createElement(\"div\");\nactivityIndicator.setAttribute(\"id\", \"ilb-activity-indicator\");\nactivityIndicator.appendChild(document.createElement(\"div\"));\n\nexport function addActivityIndicatorToDOM(): void {\n  getContainer().appendChild(activityIndicator);\n}\n\nexport function removeActivityIndicatorFromDOM(): void {\n  activityIndicator.remove();\n}\n","import \"./arrows.css\";\nimport \"./button.css\";\nimport { getContainer } from \"./container\";\n\nconst leftArrow = document.createElement(\"div\");\nleftArrow.classList.add(\"ilb-button\", \"ilb-arrow\");\nleftArrow.setAttribute(\"id\", \"ilb-arrow-left\");\nconst rightArrow = document.createElement(\"div\");\nrightArrow.classList.add(\"ilb-button\", \"ilb-arrow\");\nrightArrow.setAttribute(\"id\", \"ilb-arrow-right\");\n\nlet wrappedLeft: ((e: Event) => void) | null = null;\nlet wrappedRight: ((e: Event) => void) | null = null;\n\nexport function addArrowsToDOM(onleft: () => void, onright: () => void): void {\n  wrappedLeft = (e): void => {\n    e.stopPropagation();\n    onleft();\n  };\n  wrappedRight = (e): void => {\n    e.stopPropagation();\n    onright();\n  };\n  leftArrow.addEventListener(\"click\", wrappedLeft);\n  leftArrow.addEventListener(\"touchend\", wrappedLeft);\n  rightArrow.addEventListener(\"click\", wrappedRight);\n  rightArrow.addEventListener(\"touchend\", wrappedRight);\n  getContainer().append(leftArrow, rightArrow);\n}\n\nexport function removeArrowsFromDOM(): void {\n  leftArrow.remove();\n  if (wrappedLeft !== null) {\n    leftArrow.removeEventListener(\"click\", wrappedLeft);\n    leftArrow.removeEventListener(\"touchend\", wrappedLeft);\n  }\n  if (wrappedRight !== null) {\n    rightArrow.removeEventListener(\"click\", wrappedRight);\n    rightArrow.removeEventListener(\"touchend\", wrappedRight);\n  }\n  wrappedLeft = null;\n  wrappedRight = null;\n}\n","import \"./caption.css\";\nimport { getContainer } from \"./container\";\n\nconst caption = document.createElement(\"caption\");\ncaption.setAttribute(\"id\", \"ilb-caption\");\ncaption.textContent = \"&nbsp;\";\ncaption.addEventListener(\"click\", (e) => {\n  e.stopPropagation();\n});\n\nexport function setCaption(captionText: string, animationSpeed: number): void {\n  if (captionText !== \"\") {\n    getContainer().appendChild(caption);\n    caption.style.transition = `opacity ${animationSpeed.toString()}ms ease`;\n    setTimeout(() => {\n      caption.style.opacity = \"1\";\n    }, 1);\n    caption.textContent = captionText;\n  } else {\n    caption.style.opacity = \"0\";\n    setTimeout(() => {\n      caption.remove();\n    }, animationSpeed);\n  }\n}\n","import \"./button.css\";\nimport \"./close-button.css\";\nimport { getContainer } from \"./container\";\n\nconst closeButton = document.createElement(\"button\");\ncloseButton.classList.add(\"ilb-button\");\ncloseButton.setAttribute(\"id\", \"ilb-close-button\");\n\nlet wrappedClose: ((e: Event) => void) | null = null;\n\nexport function addCloseButtonToDOM(onclick: () => void): void {\n  wrappedClose = (e): void => {\n    e.stopPropagation();\n    onclick();\n  };\n  closeButton.addEventListener(\"click\", wrappedClose);\n  getContainer().appendChild(closeButton);\n}\n\nexport function removeCloseButtonFromDOM(): void {\n  if (wrappedClose !== null) {\n    closeButton.removeEventListener(\"click\", wrappedClose);\n  }\n  closeButton.remove();\n}\n","import { getContainer } from \"./container\";\n\nexport const fullscreenEnabled: boolean =\n  // eslint-disable-next-line compat/compat -- The prefixed version fixes the incompatibility\n  document.fullscreenEnabled ||\n  ((document as LegacyDocument).webkitFullscreenEnabled ?? false);\n\nfunction fullscreenElement(): Element | null {\n  return (\n    // eslint-disable-next-line compat/compat -- The prefixed version fixes the incompatibility\n    document.fullscreenElement ??\n    (document as LegacyDocument).webkitFullscreenElement ??\n    null\n  );\n}\n\n/* eslint-disable compat/compat, @typescript-eslint/no-unnecessary-condition, @typescript-eslint/strict-boolean-expressions -- Polyfills for very old browsers */\nconst requestFullscreen = (element: HTMLElement): void => {\n  void (\n    element.requestFullscreen ||\n    (element as LegacyHTMLElement).webkitRequestFullScreen\n  ).call(element);\n};\n\nconst exitFullscreen = (): void => {\n  void (\n    document.exitFullscreen || (document as LegacyDocument).webkitExitFullscreen\n  ).call(document);\n};\n/* eslint-enable */\n\nexport function toggleFullscreen(): void {\n  if (fullscreenElement() === null) {\n    requestFullscreen(getContainer());\n  } else {\n    exitFullscreen();\n  }\n}\n","import \"./button.css\";\nimport { getContainer } from \"./container\";\nimport { toggleFullscreen } from \"./fullscreen\";\nimport \"./fullscreen-button.css\";\n\nconst fullscreenButton = document.createElement(\"button\");\nfullscreenButton.classList.add(\"ilb-button\");\nfullscreenButton.setAttribute(\"id\", \"ilb-fullscreen-button\");\nfullscreenButton.innerHTML = \"&#x26F6;\";\nfullscreenButton.addEventListener(\"click\", (e): void => {\n  e.stopPropagation();\n  toggleFullscreen();\n});\n\nexport function addFullscreenButtonToDOM(): void {\n  getContainer().appendChild(fullscreenButton);\n}\n\nexport function removeFullscreenButtonFromDOM(): void {\n  fullscreenButton.remove();\n}\n","import type { VideoCache } from \"./VideoCache\";\n\nimport { getContainer } from \"./container\";\nimport \"./ImageView.css\";\nimport { TransitionDirection } from \"./TransitionDirection\";\n\nexport interface ImageView {\n  addToDOM(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void;\n  removeFromDOM(): void;\n  startLoading(onload: () => void, onerror: () => void): void;\n  transitionIn(\n    callback: () => void,\n    previousImage: () => void,\n    nextImage: () => void,\n    closeLightbox: () => void,\n  ): void;\n  transitionOut(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void;\n}\n\nexport function ImageView(\n  image: HTMLAnchorElement,\n  options: ILBOptions,\n  videoCache: VideoCache,\n): ImageView {\n  let swipeStart = 0;\n  let swipeDiff = 0;\n  let imageElement: HTMLImageElement | HTMLVideoElement =\n    document.createElement(\"img\");\n  imageElement.addEventListener(\"error\", (e) => {\n    getContainer().dispatchEvent(\n      new CustomEvent(\"ilb:error\", {\n        bubbles: true,\n        detail: { target: e.target },\n      }),\n    );\n  });\n  imageElement.setAttribute(\"id\", \"ilb-image\");\n  imageElement.setAttribute(\"src\", image.getAttribute(\"href\") ?? \"\");\n  imageElement.setAttribute(\"srcset\", image.dataset[\"ilb2Srcset\"] ?? \"\");\n  imageElement.setAttribute(\"sizes\", image.dataset[\"ilb2Sizes\"] ?? \"\");\n  const containerElement = document.createElement(\"div\");\n  containerElement.classList.add(\"ilb-image-container\");\n  let isVideoPreloaded: boolean | undefined = undefined;\n\n  const videoId = image.dataset[\"ilb2VideoId\"];\n  let isVideo =\n    image.dataset[\"ilb2Video\"] !== undefined && videoId !== undefined;\n  if (isVideo) {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- Checked by the if above\n    const preloadedVideo = videoCache.get(videoId!);\n    if (preloadedVideo !== undefined) {\n      [imageElement, isVideoPreloaded] = preloadedVideo.element();\n    } else {\n      isVideo = false;\n    }\n  }\n  containerElement.appendChild(imageElement);\n\n  function onready(\n    callback: () => void,\n    previousImage: () => void,\n    nextImage: () => void,\n    closeLightbox: () => void,\n  ): void {\n    if (isVideo) {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- Checked by the if in the constructor\n      const preloadedVideo = videoCache.get(videoId!);\n      if (preloadedVideo?.shouldAutoplay() === true) {\n        const [videoElement, isLoaded] = preloadedVideo.element();\n        if (isLoaded) {\n          void videoElement.play();\n        } else {\n          videoElement.autoplay = true;\n        }\n      }\n    } else {\n      (imageElement as HTMLImageElement).addEventListener(\"click\", (e) => {\n        e.stopPropagation();\n        if (options.quitOnImgClick) {\n          closeLightbox();\n          return;\n        }\n        const xPosRelativeToImage =\n          (e.pageX - imageElement.offsetLeft) / imageElement.width;\n        if (xPosRelativeToImage <= 1 / 3) {\n          previousImage();\n        } else {\n          nextImage();\n        }\n      });\n    }\n    imageElement.addEventListener(\"touchstart\", (e) => {\n      swipeStart = (e as TouchEvent).touches[0].pageX;\n      imageElement.style.transitionProperty = \"opacity\";\n    });\n    imageElement.addEventListener(\"touchmove\", (e) => {\n      swipeDiff = (e as TouchEvent).touches[0].pageX - swipeStart;\n      imageElement.style.left = `${swipeDiff.toString()}px`;\n    });\n    imageElement.addEventListener(\"touchend\", (e) => {\n      e.stopPropagation();\n      imageElement.style.transitionProperty = \"left, opacity\";\n      if (swipeDiff > 50) {\n        previousImage();\n      }\n      if (swipeDiff < -50) {\n        nextImage();\n      }\n      imageElement.style.left = \"0\";\n    });\n    imageElement.addEventListener(\"touchcancel\", (e) => {\n      e.stopPropagation();\n      imageElement.style.transitionProperty = \"left, opacity\";\n      imageElement.style.left = \"0\";\n    });\n    callback();\n  }\n\n  function addToDOM(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void {\n    getContainer().appendChild(containerElement);\n    const maxSize = Math.abs(100 - options.gutter);\n    imageElement.style.maxHeight = `${maxSize.toString()}%`;\n    imageElement.style.maxWidth = `${maxSize.toString()}%`;\n    imageElement.style.left = `${(-100 * transitionDirection).toString()}px`;\n    imageElement.style.transition = `all ease ${options.animationSpeed.toString()}ms`;\n    setTimeout(callback, 50);\n  }\n\n  function startLoading(onload: () => void, onerror: () => void): void {\n    imageElement.addEventListener(\"error\", onerror);\n    if (isVideoPreloaded === true) {\n      onload();\n    } else {\n      imageElement.addEventListener(\"load\", onload);\n      imageElement.addEventListener(\"loadedmetadata\", onload);\n    }\n  }\n\n  function transitionIn(\n    callback: () => void,\n    previousImage: () => void,\n    nextImage: () => void,\n    closeLightbox: () => void,\n  ): void {\n    imageElement.style.left = \"0\";\n    imageElement.style.opacity = \"1\";\n    setTimeout(() => {\n      onready(callback, previousImage, nextImage, closeLightbox);\n    }, options.animationSpeed);\n  }\n\n  function transitionOut(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void {\n    if (transitionDirection !== TransitionDirection.None) {\n      const currentLeft = parseInt(imageElement.style.left, 10) || 0;\n      imageElement.style.left = `${(currentLeft + 100 * transitionDirection).toString()}px`;\n    }\n    imageElement.style.opacity = \"0\";\n    setTimeout(() => {\n      callback();\n    }, options.animationSpeed);\n  }\n\n  function removeFromDOM(): void {\n    containerElement.remove();\n  }\n\n  return {\n    addToDOM,\n    removeFromDOM,\n    startLoading,\n    transitionIn,\n    transitionOut,\n  };\n}\n","let keyHandler: ((e: KeyboardEvent) => void) | null = null;\n\nexport function addKeyboardNavigation(\n  options: ILBOptions,\n  closeLightbox: () => void,\n  previousImage: () => void,\n  nextImage: () => void,\n): void {\n  if (!options.enableKeyboard) {\n    return;\n  }\n  keyHandler = (e): void => {\n    if (e.key === \"Escape\") {\n      e.preventDefault();\n      closeLightbox();\n    }\n    if (e.key === \"ArrowLeft\") {\n      e.preventDefault();\n      previousImage();\n    }\n    if (e.key === \"ArrowRight\") {\n      e.preventDefault();\n      nextImage();\n    }\n  };\n  document.addEventListener(\"keyup\", keyHandler);\n}\n\nexport function removeKeyboardNavigation(): void {\n  if (keyHandler !== null) {\n    document.removeEventListener(\"keyup\", keyHandler);\n  }\n}\n","import { getContainer } from \"./container\";\nimport \"./navigation.css\";\nimport { TransitionDirection } from \"./TransitionDirection\";\n\nconst navigation = document.createElement(\"div\");\nnavigation.classList.add(\"ilb-navigation\");\n\nexport function addNavigationItems(\n  images: Array<HTMLAnchorElement>,\n  currentIndexFn: () => number | null,\n  change: (index: number, transitionDirection: TransitionDirection) => void,\n  animationSpeed: number,\n): void {\n  // eslint-disable-next-line @typescript-eslint/prefer-for-of -- The result won't be used anyway\n  for (let i = 0; i < images.length; i++) {\n    const button = document.createElement(\"button\");\n    button.style.transition = `background-color ${animationSpeed.toString()}ms ease`;\n    const buttonClick = (): void => {\n      const currentIndex = currentIndexFn();\n      if (\n        button.classList.contains(\"ilb-navigation-active\") ||\n        currentIndex === null ||\n        button.parentNode === null\n      ) {\n        return;\n      }\n      const buttonIndex = Array.prototype.indexOf.call(\n        button.parentNode.childNodes,\n        button,\n      );\n      const loadDirection =\n        buttonIndex < currentIndex\n          ? TransitionDirection.Left\n          : TransitionDirection.Right;\n      change(buttonIndex, loadDirection);\n    };\n    button.addEventListener(\"click\", buttonClick);\n    button.addEventListener(\"touchend\", buttonClick);\n    navigation.appendChild(button);\n  }\n}\n\nexport function addNavigationToDOM(\n  images: Array<HTMLAnchorElement>,\n  currentIndexFn: () => number | null,\n  change: (index: number, transitionDirection: TransitionDirection) => void,\n  animationSpeed: number,\n): void {\n  navigation.textContent = \"\";\n  addNavigationItems(images, currentIndexFn, change, animationSpeed);\n  const currentIndex = currentIndexFn();\n  if (currentIndex !== null) {\n    changeNavigationCurrent(currentIndex);\n  }\n  getContainer().appendChild(navigation);\n\n  navigation.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n  });\n  navigation.addEventListener(\"touchend\", (e) => {\n    e.stopPropagation();\n  });\n}\n\nexport function changeNavigationCurrent(currentIndex: number): void {\n  for (let i = 0; i < navigation.children.length; i++) {\n    navigation.children.item(i)?.classList.remove(\"ilb-navigation-active\");\n  }\n  navigation.children\n    .item(currentIndex)\n    ?.classList.add(\"ilb-navigation-active\");\n}\n","import type { VideoOptions } from \"./interfaces/VideoOptions\";\n\nexport interface PreloadedVideo {\n  element(): [HTMLVideoElement, boolean];\n  id(): string;\n  shouldAutoplay(): boolean;\n}\n\nexport function PreloadedVideo(\n  image: HTMLAnchorElement,\n  videoOptions: VideoOptions,\n): PreloadedVideo {\n  let tempId = image.dataset[\"ilb2Id\"];\n  // Random id\n  tempId ??= `a${(((1 + Math.random()) * 0x10000) | 0).toString(16)}`;\n  image.dataset[\"ilb2VideoId\"] = tempId;\n  const videoId = tempId;\n\n  const videoElement = document.createElement(\"video\");\n  videoElement.setAttribute(\"id\", \"ilb-image\");\n  videoElement.preload = \"metadata\";\n  videoElement.dataset[\"ilb2VideoId\"] = videoId;\n  let isLoaded = false;\n  let autoplay = false;\n\n  for (const [key, value] of Object.entries(videoOptions)) {\n    switch (key) {\n      case \"autoplay\":\n        autoplay = true;\n        break;\n      case \"controls\":\n      case \"loop\":\n      case \"muted\":\n      case \"poster\":\n      case \"preload\":\n      case \"src\":\n        videoElement.setAttribute(key, (value as number | string).toString());\n        break;\n      default:\n    }\n  }\n  if (videoOptions.sources) {\n    for (const source of videoOptions.sources) {\n      const sourceElement = document.createElement(\"source\");\n      for (const [key, value] of Object.entries(source)) {\n        sourceElement.setAttribute(key, value as string);\n      }\n      videoElement.appendChild(sourceElement);\n    }\n  }\n  videoElement.addEventListener(\"loadedmetadata\", () => {\n    isLoaded = true;\n  });\n\n  function id(): string {\n    return videoId;\n  }\n\n  function element(): [HTMLVideoElement, boolean] {\n    return [videoElement, isLoaded];\n  }\n\n  function shouldAutoplay(): boolean {\n    return autoplay;\n  }\n\n  return {\n    element,\n    id,\n    shouldAutoplay,\n  };\n}\n","import type { VideoOptions } from \"./interfaces/VideoOptions\";\n\nimport { PreloadedVideo } from \"./PreloadedVideo\";\n\nexport interface VideoCache {\n  add(elements: Array<HTMLAnchorElement>): void;\n  get(videoId: string): PreloadedVideo | undefined;\n}\n\nexport function VideoCache(): VideoCache {\n  const videos: Array<PreloadedVideo> = [];\n\n  function add(elements: Array<HTMLAnchorElement>): void {\n    for (const image of elements) {\n      const videoOptions = image.dataset[\"ilb2Video\"];\n      if (videoOptions === undefined) {\n        continue;\n      }\n      videos.push(\n        PreloadedVideo(image, JSON.parse(videoOptions) as VideoOptions),\n      );\n    }\n  }\n\n  function get(videoId: string): PreloadedVideo | undefined {\n    return videos.find((x) => x.id() === videoId);\n  }\n\n  return {\n    add,\n    get,\n  };\n}\n","import {\n  addActivityIndicatorToDOM,\n  removeActivityIndicatorFromDOM,\n} from \"./activity-indicator\";\nimport { addArrowsToDOM, removeArrowsFromDOM } from \"./arrows\";\nimport { setCaption } from \"./caption\";\nimport { addCloseButtonToDOM, removeCloseButtonFromDOM } from \"./close-button\";\nimport {\n  addContainerToDOM,\n  darkenOverlay,\n  getContainer,\n  removeContainerFromDOM,\n  transitionOutContainer,\n} from \"./container\";\nimport { fullscreenEnabled } from \"./fullscreen\";\nimport {\n  addFullscreenButtonToDOM,\n  removeFullscreenButtonFromDOM,\n} from \"./fullscreen-button\";\nimport { popHistory, pushQuitToHistory, pushToHistory } from \"./history\";\nimport { ImageView } from \"./ImageView\";\nimport {\n  addKeyboardNavigation,\n  removeKeyboardNavigation,\n} from \"./keyboard-navigation\";\nimport {\n  addNavigationItems,\n  addNavigationToDOM,\n  changeNavigationCurrent,\n} from \"./navigation\";\nimport { TransitionDirection } from \"./TransitionDirection\";\nimport { VideoCache } from \"./VideoCache\";\n\nexport interface State {\n  addImages(images: Array<HTMLAnchorElement>): void;\n  close(skipHistory?: boolean): void;\n  images(): Array<HTMLAnchorElement>;\n  next(): void;\n  open(index: number, skipHistory?: boolean): void;\n  openWithImage(image: HTMLAnchorElement): void;\n  previous(): void;\n  set(): string | undefined;\n}\n\nexport function State(\n  // The lightbox options\n  options: ILBOptions,\n  // The value of data-imagelightbox on the images\n  lightboxSet: string,\n  initialImages: Array<HTMLAnchorElement>,\n): State {\n  // The clickable images in the lightbox\n  const targetImages: Array<HTMLAnchorElement> = [];\n\n  // Cached preloaded videos\n  const videoCache: VideoCache = VideoCache();\n\n  // The index of the currently open image, or null if the lightbox is closed\n  let currentImage: number | null = null;\n\n  // The currently displayed image view\n  let currentImageView: ImageView | null = null;\n\n  // !!! State initialization is at the bottom!\n\n  function set(): string {\n    return lightboxSet;\n  }\n\n  function images(): Array<HTMLAnchorElement> {\n    return targetImages;\n  }\n\n  /**\n   * The lightbox transition functions.\n   *\n   * The most important part of the State is managing the transition lifecycle. When transitioning between images, the lifecycle takes the following steps:\n   *\n   * For transitioning out an old image:\n   *\n   * 1. Start visually transitioning the old image out (slide + fade out)\n   * 2. When the image is visually gone, actually remove it from the DOM\n   *\n   * For transitioning in a new image:\n   *\n   * 1. Start loading the new image in the background (startLoadingNewImage)\n   * 2. When the new image is loaded, add it to the DOM, but keep it invisible (addNewImage)\n   * 3. After adding the image to the DOM, transition it into place - slide + fade in (transitionInNewImage)\n   */\n\n  function removeOldImage(\n    transitionDirection: TransitionDirection,\n    callback?: () => void,\n  ): void {\n    if (currentImageView === null) {\n      return;\n    }\n    const oldImageView = currentImageView;\n    oldImageView.transitionOut(transitionDirection, () => {\n      oldImageView.removeFromDOM();\n      callback?.();\n    });\n  }\n\n  function transitionInNewImage(): void {\n    currentImageView?.transitionIn(\n      removeActivityIndicatorFromDOM,\n      previous,\n      next,\n      close,\n    );\n  }\n\n  function addNewImage(transitionDirection: TransitionDirection): void {\n    currentImageView?.addToDOM(transitionDirection, () => {\n      if (currentImage === null) {\n        return;\n      }\n      const image = targetImages[currentImage];\n      if (options.caption) {\n        setCaption(\n          image.dataset[\"ilb2Caption\"] ??\n            image.getElementsByTagName(\"img\").item(0)?.alt ??\n            \"\",\n          options.animationSpeed,\n        );\n      }\n      transitionInNewImage();\n      if (options.preloadNext && currentImage + 1 < targetImages.length) {\n        const nextImage = targetImages[currentImage + 1];\n        const nextImageElement = document.createElement(\"img\");\n        nextImageElement.setAttribute(\n          \"src\",\n          nextImage.getAttribute(\"href\") ?? \"\",\n        );\n        nextImageElement.setAttribute(\n          \"srcset\",\n          nextImage.dataset[\"ilb2Srcset\"] ?? \"\",\n        );\n        nextImageElement.setAttribute(\n          \"sizes\",\n          nextImage.dataset[\"ilb2Sizes\"] ?? \"\",\n        );\n      }\n      getContainer().dispatchEvent(new Event(\"ilb:loaded\", { bubbles: true }));\n    });\n  }\n\n  function startLoadingNewImage(\n    newIndex: number,\n    transitionDirection: TransitionDirection,\n  ): void {\n    const newImageView = ImageView(targetImages[newIndex], options, videoCache);\n    currentImage = newIndex;\n    currentImageView = newImageView;\n    newImageView.startLoading(\n      () => {\n        addNewImage(transitionDirection);\n      },\n      () => {\n        removeActivityIndicatorFromDOM();\n      },\n    );\n  }\n\n  // Public functions wrapping the state transition functions\n\n  function close(skipHistory = false): void {\n    if (currentImage === null) {\n      return;\n    }\n    if (options.activity) {\n      addActivityIndicatorToDOM();\n    }\n\n    removeKeyboardNavigation();\n\n    if (options.history && !skipHistory) {\n      pushQuitToHistory();\n    }\n\n    getContainer().dispatchEvent(new Event(\"ilb:quit\", { bubbles: true }));\n\n    transitionOutContainer();\n    removeOldImage(TransitionDirection.None, () => {\n      currentImage = null;\n      currentImageView = null;\n      removeArrowsFromDOM();\n      removeCloseButtonFromDOM();\n      removeFullscreenButtonFromDOM();\n      removeContainerFromDOM();\n    });\n  }\n\n  function change(\n    index: number,\n    transitionDirection: TransitionDirection,\n    skipHistory = false,\n  ): void {\n    if (currentImage === null) {\n      return;\n    }\n\n    if (options.history && !skipHistory) {\n      pushToHistory(index, set(), images());\n    }\n\n    if (options.activity) {\n      addActivityIndicatorToDOM();\n    }\n    changeNavigationCurrent(index);\n\n    removeOldImage(transitionDirection);\n    startLoadingNewImage(index, transitionDirection);\n  }\n\n  function previous(): void {\n    if (currentImage === null) {\n      return;\n    }\n\n    let newIndex = currentImage - 1;\n    if (currentImage === 0) {\n      if (options.quitOnEnd) {\n        close();\n        return;\n      }\n      newIndex = targetImages.length - 1;\n    }\n    targetImages[newIndex].dispatchEvent(\n      new Event(\"ilb:previous\", { bubbles: true }),\n    );\n    change(newIndex, TransitionDirection.Left);\n  }\n\n  function next(): void {\n    if (currentImage === null) {\n      return;\n    }\n\n    let newIndex = currentImage + 1;\n    if (currentImage === targetImages.length - 1) {\n      if (options.quitOnEnd) {\n        close();\n        return;\n      }\n      newIndex = 0;\n    }\n    targetImages[newIndex].dispatchEvent(\n      new Event(\"ilb:next\", { bubbles: true }),\n    );\n    change(newIndex, TransitionDirection.Right);\n  }\n\n  function open(index: number, skipHistory = false): void {\n    if (currentImage !== null) {\n      return;\n    }\n    addContainerToDOM(options.animationSpeed, options.quitOnDocClick, close);\n    if (options.activity) {\n      addActivityIndicatorToDOM();\n    }\n    addKeyboardNavigation(options, close, previous, next);\n    if (options.arrows) {\n      addArrowsToDOM(previous, next);\n    }\n    if (options.button) {\n      addCloseButtonToDOM(close);\n    }\n    if (options.fullscreen && fullscreenEnabled) {\n      addFullscreenButtonToDOM();\n    }\n    if (options.overlay) {\n      darkenOverlay();\n    }\n\n    if (options.history && !skipHistory) {\n      pushToHistory(index, set(), images());\n    }\n\n    targetImages[index].dispatchEvent(\n      new Event(\"ilb:start\", { bubbles: true }),\n    );\n    startLoadingNewImage(index, TransitionDirection.None);\n\n    // Navigation needs to know current image, so it needs to be added after startLoadingNewImage\n    if (options.navigation) {\n      addNavigationToDOM(\n        images(),\n        () => currentImage,\n        change,\n        options.animationSpeed,\n      );\n    }\n  }\n\n  function openWithImage(image: HTMLAnchorElement): void {\n    const index = targetImages.indexOf(image);\n    if (index < 0) {\n      return;\n    }\n    open(index);\n  }\n\n  function addImages(newImages: Array<HTMLAnchorElement>): void {\n    const validImages = newImages\n      .filter((x) => !targetImages.includes(x))\n      .filter(\n        (element): boolean =>\n          element.tagName.toLowerCase() === \"a\" &&\n          (new RegExp(`.(${options.allowedTypes})$`, \"i\").test(element.href) ||\n            element.dataset[\"ilb2Srcset\"] !== undefined ||\n            element.dataset[\"ilb2Video\"] !== undefined),\n      );\n    videoCache.add(validImages);\n    targetImages.push(...validImages);\n    for (const image of validImages) {\n      image.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        openWithImage(image);\n      });\n    }\n    addNavigationItems(\n      validImages,\n      () => currentImage,\n      change,\n      options.animationSpeed,\n    );\n  }\n\n  // State initialization\n\n  addImages(initialImages);\n\n  if (options.history) {\n    window.addEventListener(\"popstate\", (e) => {\n      popHistory(e, set(), images(), currentImage, open, close, change);\n    });\n  }\n\n  return {\n    addImages,\n    close,\n    images,\n    next,\n    open,\n    openWithImage,\n    previous,\n    set,\n  };\n}\n","import { openHistory } from \"./history\";\nimport { State } from \"./State\";\n\nexport class ImageLightbox {\n  private readonly s: State;\n\n  public constructor(\n    images:\n      | Array<HTMLAnchorElement>\n      | HTMLCollectionOf<HTMLAnchorElement>\n      | NodeListOf<HTMLAnchorElement>,\n    options?: Partial<ILBOptions>,\n  ) {\n    const opts: ILBOptions = {\n      activity: true,\n      allowedTypes: \"\",\n      animationSpeed: 250,\n      arrows: true,\n      button: true,\n      caption: false,\n      enableKeyboard: true,\n      fullscreen: true,\n      gutter: 10,\n      history: false,\n      navigation: false,\n      overlay: true,\n      preloadNext: true,\n      quitOnDocClick: true,\n      quitOnEnd: true,\n      quitOnImgClick: false,\n      ...options,\n    };\n    this.s = State(\n      opts,\n      images.length > 0 ? (images[0].dataset[\"imagelightbox\"] ?? \"\") : \"\",\n      Array.from(images),\n    );\n\n    if (opts.history) {\n      this.openHistory();\n    }\n  }\n\n  public addImages(\n    images:\n      | Array<HTMLAnchorElement>\n      | HTMLCollectionOf<HTMLAnchorElement>\n      | NodeListOf<HTMLAnchorElement>,\n  ): void {\n    this.s.addImages(Array.from(images));\n  }\n\n  public close(): void {\n    this.s.close();\n  }\n\n  public next(): void {\n    this.s.next();\n  }\n\n  public open(image?: HTMLAnchorElement): void {\n    if (image !== undefined) {\n      this.s.openWithImage(image);\n    } else {\n      this.s.open(0);\n    }\n  }\n\n  public openHistory(): void {\n    openHistory(\n      this.s.set(),\n      this.s.images(),\n      (index: number, skipHistory?: boolean) => {\n        this.s.open(index, skipHistory);\n      },\n    );\n  }\n\n  public previous(): void {\n    this.s.previous();\n  }\n}\n","import { ImageLightbox } from \"./lib/imagelightbox\";\n\ndeclare const TEST: boolean | undefined;\nconst isTest: boolean = typeof TEST !== \"undefined\" ? TEST : false;\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"basic\"]'), {\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"responsive\"]'),\n  {\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"video\"]'), {\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"minimal\"]'),\n  {\n    activity: false,\n    arrows: false,\n    button: false,\n    fullscreen: false,\n    overlay: false,\n    quitOnDocClick: false,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"caption\"]'),\n  {\n    caption: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"navigation\"]'),\n  {\n    navigation: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"quit\"]'), {\n  quitOnDocClick: false,\n  quitOnEnd: false,\n  quitOnImgClick: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"history\"]'),\n  {\n    history: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"history-ids\"]'),\n  {\n    history: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"allowedtypes\"]'),\n  {\n    allowedTypes: \"gif\",\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nconst manualOpenGallery = new ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"trigger\"]'),\n  {\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\ndocument\n  .getElementsByClassName(\"trigger_lightbox\")\n  .item(0)\n  ?.addEventListener(\"click\", () => {\n    manualOpenGallery.open();\n  });\n\nconst dynamicAddingGallery = new ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"dynamic\"]'),\n  {\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\ndocument\n  .getElementsByClassName(\"add_image\")\n  .item(0)\n  ?.addEventListener(\"click\", () => {\n    const linkContainer = document\n      .getElementsByClassName(\"demo_dynamic\")\n      .item(0);\n    const newLi = document.createElement(\"li\");\n    linkContainer?.appendChild(newLi);\n\n    const newAnchor = document.createElement(\"a\");\n    newAnchor.dataset[\"imagelightbox\"] = \"dynamic\";\n    newAnchor.href = \"images/demo4.jpg\";\n    newLi.appendChild(newAnchor);\n\n    const newImg = document.createElement(\"img\");\n    newImg.src = \"images/thumb4.jpg\";\n    newAnchor.appendChild(newImg);\n\n    dynamicAddingGallery.addImages(\n      document.querySelectorAll('a[data-imagelightbox=\"dynamic\"]'),\n    );\n  });\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"events\"]'), {\n  ...(isTest && { animationSpeed: 0 }),\n});\n\n/* eslint-disable no-console -- This is the docs */\ndocument.addEventListener(\"ilb:start\", (e) => {\n  console.log(\"ilb:start\");\n  console.log(e.target);\n});\ndocument.addEventListener(\"ilb:quit\", () => {\n  console.log(\"ilb:quit\");\n});\ndocument.addEventListener(\"ilb:loaded\", () => {\n  console.log(\"ilb:loaded\");\n});\ndocument.addEventListener(\"ilb:previous\", (e) => {\n  console.log(\"ilb:previous\");\n  console.log(e.target);\n});\ndocument.addEventListener(\"ilb:next\", (e) => {\n  console.log(\"ilb:next\");\n  console.log(e.target);\n});\ndocument.addEventListener(\"ilb:error\", (e) => {\n  console.log(\"ilb:error\");\n  console.log(e.detail);\n});\n/* eslint-enable no-console */\n"],"names":["addQueryField","query","key","value","newField","newQuery","keyRegex","getQueryField","keyValuePair","removeQueryField","keyRegex1","keyRegex2","TransitionDirection","openHistory","set","images","open","id","newIndex","image","popHistory","event","currentIndex","close","change","historyState","newId","e","pushQuitToHistory","pushToHistory","index","newHistoryState","container","wrappedOnclick","addContainerToDOM","animationSpeed","attachOnclick","onclick","darkenOverlay","getContainer","removeContainerFromDOM","transitionOutContainer","activityIndicator","addActivityIndicatorToDOM","removeActivityIndicatorFromDOM","leftArrow","rightArrow","wrappedLeft","wrappedRight","addArrowsToDOM","onleft","onright","removeArrowsFromDOM","caption","setCaption","captionText","closeButton","wrappedClose","addCloseButtonToDOM","removeCloseButtonFromDOM","fullscreenEnabled","fullscreenElement","requestFullscreen","element","exitFullscreen","toggleFullscreen","fullscreenButton","addFullscreenButtonToDOM","removeFullscreenButtonFromDOM","ImageView","options","videoCache","swipeStart","swipeDiff","imageElement","containerElement","isVideoPreloaded","videoId","isVideo","preloadedVideo","onready","callback","previousImage","nextImage","closeLightbox","videoElement","isLoaded","addToDOM","transitionDirection","maxSize","startLoading","onload","onerror","transitionIn","transitionOut","currentLeft","removeFromDOM","keyHandler","addKeyboardNavigation","removeKeyboardNavigation","navigation","addNavigationItems","currentIndexFn","button","buttonClick","buttonIndex","loadDirection","addNavigationToDOM","changeNavigationCurrent","i","PreloadedVideo","videoOptions","tempId","autoplay","source","sourceElement","shouldAutoplay","VideoCache","videos","add","elements","get","x","State","lightboxSet","initialImages","targetImages","currentImage","currentImageView","removeOldImage","oldImageView","transitionInNewImage","previous","next","addNewImage","nextImageElement","startLoadingNewImage","newImageView","skipHistory","openWithImage","addImages","newImages","validImages","ImageLightbox","opts","isTest","manualOpenGallery","dynamicAddingGallery","linkContainer","newLi","newAnchor","newImg"],"mappings":"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"}