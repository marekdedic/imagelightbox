!function(D,R,z){"use strict";var X=D("<div/>").attr("class","imagelightbox-loading").append(D("<div/>")),t=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),e=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),j=t.add(e),N=D("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),U=D("<button/>",{type:"button",class:"imagelightbox-close"}),V=D("<div/>",{class:"imagelightbox-overlay"}),K=D("<a/>",{href:"#",class:"imagelightbox-navitem"}),Y=D("<div/>",{class:"imagelightbox-nav"}),_=D("<div/>",{class:"imagelightbox-wrapper"}),H=D("body"),o=function(){var t=z.body||z.documentElement;return""===(t=t.style).transition?"":""===t.WebkitTransition?"-webkit-":""===t.MozTransition?"-moz-":""===t.OTransition&&"-o-"},W=!1!==o(),$=function(t,e,i){var n={},a=o();n[a+"transform"]="translateX("+e+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s ease-in",t.css(n)},B="ontouchstart"in R,Q=R.navigator.pointerEnabled||R.navigator.msPointerEnabled,A=function(t){if(B)return!0;if(!Q||void 0===t||void 0===t.pointerType)return!1;if(void 0!==t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!==t.pointerType)return!0}else if("mouse"!==t.pointerType)return!0;return!1},G=!!(z.fullscreenEnabled||z.webkitFullscreenEnabled||z.mozFullScreenEnabled||z.msFullscreenEnabled),J=!(!R.history||!history.pushState);D.fn.imageLightbox=function(t){var i="",s=D([]),u=D(),g=D([]),r=-1,d=D(),f=0,h=!1,n=0,p=D.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},t),b=function(){p.activity&&y(),p.arrows&&j.css("display","block")},a=function(t,e,i){var n=e+"="+i,a="?"+n;if(t){var o=new RegExp("([?&])"+e+"=[^&]*");a=null!==t.match(o)?t.replace(o,"$1"+n):t+"&"+n}return a},o=function(){if(J&&p.history){var t=s[r].dataset.ilb2Id;t||(t=r);var e={imageLightboxIndex:t},i=s[r].dataset.imagelightbox;i&&(e.imageLightboxSet=i);var n=a(z.location.search,"imageLightboxIndex",t);i&&(n=a(n,"imageLightboxSet",i)),R.history.pushState(e,"",z.location.pathname+n)}},e=function(t,e){var i=t;if(i){var n=new RegExp("\\?"+e+"=[^&]*"),a=new RegExp("&"+e+"=[^&]*");i=(i=i.replace(n,"?")).replace(a,"")}return i},l=function(t){var e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(z.location.search);if(e&&e[2])return decodeURIComponent(e[2].replace(/\+/g," "))},c=function(){if(J&&p.history){var t=l("imageLightboxIndex");if(t){var e=s.filter('[data-ilb2-id="'+t+'"]');0<e.length?r=s.index(e):e=D(s[r=t]);var i=l("imageLightboxSet");!e[0]||i&&i!==e[0].dataset.imagelightbox||L(e,!0)}}},m=function(){if(--r<0){if(!0===p.quitOnEnd)return void P();r=s.length-1}u=s.eq(r),o(),_.trigger("previous.ilb2",u),O(1)},v=function(){if(++r>=s.length){if(!0===p.quitOnEnd)return void P();r=0}o(),u=s.eq(r),_.trigger("next.ilb2",u),O(-1)},x=function(){_.append(X)},y=function(){D(".imagelightbox-loading").remove()},E=function(){_.append(V)},w=function(){U.appendTo(_).on("click.ilb7",function(){return P(),!1})},S=function(){N.css("opacity","0"),N.html("&nbsp;"),D(u).data("ilb2-caption")?(N.css("opacity","1"),N.html(D(u).data("ilb2-caption"))):D(u).find("img").attr("alt")&&(N.css("opacity","1"),N.html(D(u).find("img").attr("alt")))},q=function(){if(s.length){for(var t=0;t<s.length;t++)Y.append(K.clone());var e=Y.children("a");e.eq(s.index(u)).addClass("active"),_.on("previous.ilb2 next.ilb2",function(){e.removeClass("active").eq(s.index(u)).addClass("active")}),_.append(Y),Y.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t=D(this);if(s.eq(t.index()).attr("href")!==D(".imagelightbox").attr("src")){var e=s.eq(t.index());e.length&&(n=s.index(u),u=e,O(t.index()<n?-1:1))}t.addClass("active").siblings().removeClass("active")})}},I=function(){_.append(j),j.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),D(this).hasClass("imagelightbox-arrow-left")?m():v(),!1})},k=function(){if(!d.length)return!0;var t=p.caption?N.outerHeight():0,r=D(R).width(),l=D(R).height()-t,c=Math.abs(1-p.gutter/100);function e(t,e){if(r<t||l<e){var i=r/l<t/e?t/r:e/l;t/=i,e/=i}var n=e*c,a=t*c,o=(D(R).width()-a)/2;d.css({width:a+"px",height:n+"px",left:o+"px"})}if(void 0===d.get(0).videoWidth){var i=new Image;i.src=d.attr("src"),i.onload=function(){e(i.width,i.height)}}else e(d.get(0).videoWidth,d.get(0).videoHeight)},O=function(c){if(h)return!1;if(d.length){var t={opacity:0};W?$(d,100*c-f+"px",p.animationSpeed/1e3):t.left=parseInt(d.css("left"))+100*c+"px",d.animate(t,p.animationSpeed,function(){C()}),f=0}h=!0,p.activity&&x(),p.caption&&S(),setTimeout(function(){var t,e,i=u.attr("href"),n=0,a=0,o=0,r=u.data("ilb2Video");function l(){var t={opacity:1};if(d.appendTo(_),k(),d.css("opacity",0),W)$(d,-100*c+"px",0),setTimeout(function(){$(d,"0px",p.animationSpeed/1e3)},50);else{var e=parseInt(d.css("left"));t.left=e+"px",d.css("left",e-100*c+"px")}if(d.animate(t,p.animationSpeed,function(){h=!1,b()}),p.preloadNext){var i=s.eq(s.index(u)+1);i.length||(i=s.eq(0)),D("<img />").attr("src",i.attr("href"))}_.trigger("loaded.ilb2")}r?g.each(function(){this.i===u.data("ilb2VideoId")&&(t=this.l,e=this.e,this.a&&(!1===t&&e.attr("autoplay",this.a),!0===t&&e.get(0).play()))}):e=D("<img id='"+p.id+"' />").attr("src",i),d=e.on("load.ilb7",l).on("error.ilb7",function(){b()}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(t){if(!A(t.originalEvent)||p.quitOnImgClick)return!0;W&&(o=parseInt(d.css("left"))),n=t.originalEvent.pageX||t.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(t){if(!Q&&"pointermove"===t.type||!A(t.originalEvent)||p.quitOnImgClick)return!0;t.preventDefault(),a=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,f=n-a,W?$(d,-f+"px",0):d.css("left",o-f+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(t){if(!A(t.originalEvent)||p.quitOnImgClick)return!0;50<Math.abs(f)?f<0?m():v():W?$(d,"0px",p.animationSpeed/1e3):d.animate({left:o+"px"},p.animationSpeed/2)}),!0===t&&l(),!1===t&&(d=d.on("loadedmetadata.ilb7",l)),r||(d=d.on(Q?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(t){if(t.preventDefault(),p.quitOnImgClick)return P(),!1;if(A(t.originalEvent))return!0;var e=(t.pageX||t.originalEvent.pageX)-t.target.offsetLeft;t.target.width/2>e?m():v()}))},p.animationSpeed+100)},C=function(){if(!d.length)return!1;d.remove(),d=D()},T=function(t){D("[data-imagelightbox]").data("imagelightbox-inactive",t)},L=function(t,e){var i=!0===t.data("imagelightbox-inactive");return!i&&!h&&(h=!1,u=t,r=s.index(u),e||o(),function(){p.arrows&&I(this),p.navigation&&q(),p.overlay&&E(),p.button&&w(),p.caption&&_.append(N)}(),H.append(_).addClass("imagelightbox-open"),_.trigger("start.ilb2",t),T(!0),void O(0))},P=function(t){if(r=-1,t||function(){if(J&&p.history){var t=e(z.location.search,"imageLightboxIndex");t=e(t,"imageLightboxSet"),R.history.pushState({},"",z.location.pathname+t)}}(),_.trigger("quit.ilb2"),H.removeClass("imagelightbox-open"),!d.length)return!1;d.animate({opacity:0},p.animationSpeed,function(){C(),h=!1,_.remove().find("*").remove()}),T(!1)},F=function(e){e.each(function(){s=e.add(D(this))}),e.on("click.ilb7",{set:i},function(t){t.preventDefault(),i=D(t.currentTarget).data("imagelightbox"),e.filter(function(){return D(this).data("imagelightbox")===i}).filter(function(){return function(t){return"a"===D(t).prop("tagName").toLowerCase()&&(new RegExp(".("+p.allowedTypes+")$","i").test(D(t).attr("href"))||D(t).data("ilb2Video"))}(D(this))}).each(function(){s=s.add(D(this))}),s.length<1?P():L(D(this))})},M=function(t){t.each(function(){var t=D(this).data("ilb2Video");if(t){var e=D(this).data("ilb2Id");e||(e="a"+(65536*(1+Math.random())|0).toString(16)),D(this).data("ilb2VideoId",e);var n={e:D("<video id='"+p.id+"' preload='metadata'>"),i:e,l:!1,a:void 0};D.each(t,function(t,e){"autoplay"===t?n.a=e:"sources"!==t&&(n.e=n.e.attr(t,e))}),t.sources&&D.each(t.sources,function(t,e){var i=D("<source>");D.each(e,function(t,e){i=i.attr(t,e)}),n.e.append(i)}),n.e.on("loadedmetadata.ilb7",function(){n.l=!0}),g=g.add(n)}})};return D(R).on("resize.ilb7",k),J&&p.history&&D(R).on("popstate",function(t){var e=t.originalEvent.state;if(e){var i=e.imageLightboxIndex;if(void 0!==i){var n=s.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var a=s.index(n);else n=D(s[a=i]);if(n[0]&&(!e.imageLightboxSet||e.imageLightboxSet===n[0].dataset.imagelightbox))if(r<0)L(n,!0);else{var o=1;r<a&&(o=-1),u=n,r=a,O(o)}}else P(!0)}else P(!0)}),D(z).ready(function(){p.quitOnDocClick&&D(z).on(B?"touchend.ilb7":"click.ilb7",function(t){d.length&&!D(t.target).is(d)&&(t.preventDefault(),P())}),p.fullscreen&&G&&D(z).on("keydown.ilb7",function(t){if(!d.length)return!0;-1<[9,32,38,40].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault()),-1<[13].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),function(){var t=R.document,e=z.getElementById(p.id).parentElement,i=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen,n=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement?n.call(t):i.call(e)}())}),p.enableKeyboard&&D(z).on("keydown.ilb7",function(t){if(!d.length)return!0;-1<[27].indexOf(t.which)&&p.quitOnEscKey&&(t.stopPropagation(),t.preventDefault(),P()),-1<[37].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),m()),-1<[39].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),v())})}),D(z).off("click",p.selector),F(D(this)),c(),M(s),this.addToImageLightbox=function(t){F(t),M(t)},this.openHistory=function(){c()},this.loadPreviousImage=function(){m()},this.loadNextImage=function(){v()},this.quitImageLightbox=function(){return P(),this},this.startImageLightbox=function(t){t?t.trigger("click.ilb7"):D(this).trigger("click.ilb7")},this}}("object"==typeof module&&"object"==typeof module.exports?require("jquery"):jQuery,window,document);