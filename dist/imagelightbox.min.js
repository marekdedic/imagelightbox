!function(e,t,n){"use strict";var i=e("<div/>").attr("class","imagelightbox-loading").append(e("<div/>")),o=e("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),r=e("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),a=o.add(r),l=e("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),c=e("<a/>",{class:"imagelightbox-close"}),s=e("<div/>",{class:"imagelightbox-overlay"}),u=e("<a/>",{href:"#",class:"imagelightbox-navitem"}),h=e("<div/>",{class:"imagelightbox-nav"}),g=e("<div/>",{class:"imagelightbox-wrapper"}),f=function(){var e=n.body||n.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},p=!1!==f(),d=function(e,t,n){var i={},o=f();i[o+"transform"]="translateX("+t+")",i[o+"transition"]=o+"transform "+n+"s linear",e.css(i)},v="ontouchstart"in t,b=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,m=function(e){if(v)return!0;if(!b||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},x=!1!=!!(n.fullscreenEnabled||n.webkitFullscreenEnabled||n.mozFullScreenEnabled||n.msFullscreenEnabled);e.fn.imageLightbox=function(o){function r(e){return e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),!1}function f(){return n.exitFullscreen?n.exitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitExitFullscreen&&n.webkitExitFullscreen(),!1}function E(){r(n.getElementById(w.id).parentElement)||f()}var w=e.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,lockBody:!1,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},o),y=function(){w.arrows&&Y(this),w.navigation&&M(),w.overlay&&T(),w.button&&X(),w.caption&&g.append(l)},k=function(){w.activity&&C(),w.caption&&F()},q=function(){w.activity&&I(),w.arrows&&a.css("display","block")},O=function(){var e=D.index(R)-1;if(e<0){if(!0===w.quitOnEnd)return $(),!1;e=D.length-1}R=D.eq(e),g.trigger("previous.ilb2"),H(-1)},S=function(){var e=D.index(R)+1;if(e>=D.length){if(!0===w.quitOnEnd)return $(),!1;e=0}R=D.eq(e),g.trigger("next.ilb2"),H(1)},C=function(){g.append(i)},I=function(){e(".imagelightbox-loading").remove()},T=function(){g.append(s)},X=function(){c.appendTo(g).on("click.ilb7",function(){return $(),!1})},F=function(){l.html("&nbsp;"),e(R).data("ilb2-caption")?l.html(e(R).data("ilb2-caption")):e(R).find("img").length>0&&l.html(e(R).find("img").attr("alt"))},M=function(){if(D.length){for(var t=0;t<D.length;t++)h.append(u.clone());var n=h.children("a");n.eq(D.index(R)).addClass("active"),g.on("previous.ilb2 next.ilb2",function(){n.removeClass("active").eq(D.index(R)).addClass("active")}),g.append(h),h.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t=e(this);if(D.eq(t.index()).attr("href")!==e(".imagelightbox").attr("src")){var n=D.eq(t.index());n.length&&(K=D.index(R),R=n,H(t.index()<K?-1:1))}t.addClass("active").siblings().removeClass("active")})}},Y=function(){g.append(a),a.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),e(this).hasClass("imagelightbox-arrow-left")?O():S(),!1})},P="",D=e([]),R=e(),z=e(),B=0,L=0,N=0,j=!1,K=0,U=function(e){var t=w.allowedTypes;if(!/^(?!\|)[\w|]+(?!\|)$/.test(t))return!1;var i=function(e){var t,i,o,r=n.createElement("a"),a={};for(r.href=e,t=r.search.replace(/^\?/,"").split("&"),o=0;o<t.length;o++)a[(i=t[o].split("="))[0]]=i[1];return{protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,searchObject:a,hash:r.hash}}(e.attr("href")).pathname;return new RegExp(t,"i").test(i)},_=function(){if(!z.length)return!0;var n=w.caption?l.outerHeight():0,i=e(t).width(),o=e(t).height()-n,r=Math.abs(1-w.gutter/100),a=new Image;a.src=z.attr("src"),a.onload=function(){if(B=a.width,L=a.height,B>i||L>o){var n=B/L>i/o?B/i:L/o;B/=n,L/=n}var l=L*r,c=B*r,s=(1+w.offsetY/100)*(e(t).height()-l)/2,u=(e(t).width()-c)/2;z.css({width:c+"px",height:l+"px",top:s+"px",left:u+"px"})}},H=function(n){if(j)return!1;if(z.length){var i={opacity:0};p?d(z,100*n-N+"px",w.animationSpeed/1e3):i.left=parseInt(z.css("left"))+100*n+"px",z.animate(i,w.animationSpeed,function(){Q()}),N=0}j=!0,k(),setTimeout(function(){var i=R.attr("href");z=e('<img id="'+w.id+'" />').attr("src",i).on("load.ilb7",function(){var t={opacity:1};if(z.appendTo(g),_(),z.css("opacity",0),p)d(z,-100*n+"px",0),setTimeout(function(){d(z,"0px",w.animationSpeed/1e3)},50);else{var i=parseInt(z.css("left"));t.left=i+"px",z.css("left",i-100*n+"px")}if(z.animate(t,w.animationSpeed,function(){j=!1,q()}),w.preloadNext){var o=D.eq(D.index(R)+1);o.length||(o=D.eq(0)),e("<img />").attr("src",o.attr("href"))}g.trigger("loaded.ilb2")}).on("error.ilb7",function(){q()});var o=0,r=0,a=0,l=!1,c=!1,s=0,u=0,h=!1,f=1,v=1;z.on(b?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){if(e.preventDefault(),w.quitOnImgClick)return $(),!1;if(m(e.originalEvent))return!0;var t=(e.pageX||e.originalEvent.pageX)-e.target.offsetLeft;B/2>t?O():S()}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!m(e.originalEvent)||w.quitOnImgClick)return!0;"touchstart"==e.type&&2==e.originalEvent.touches.length&&(l=!0,v=Math.sqrt((e.originalEvent.touches[0].screenX-e.originalEvent.touches[1].screenX)*(e.originalEvent.touches[0].screenX-e.originalEvent.touches[1].screenX)+(e.originalEvent.touches[0].screenY-e.originalEvent.touches[1].screenY)*(e.originalEvent.touches[0].screenY-e.originalEvent.touches[1].screenY)),console.log(v)),c||(p&&(a=parseInt(z.css("left"))),o=e.originalEvent.pageX||e.originalEvent.touches[0].pageX),c&&1==e.originalEvent.touches.length&&(s=e.originalEvent.touches[0].screenX,u=e.originalEvent.touches[0].screenY,h=!0)}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(n){if(!c){if(!b&&"pointermove"===n.type||!m(n.originalEvent)||w.quitOnImgClick)return!0;n.preventDefault(),r=n.originalEvent.pageX||n.originalEvent.touches[0].pageX,N=o-r,p?d(z,-N+"px",0):z.css("left",a-N+"px")}h&&(z.css({top:parseInt(z.css("top"))+n.originalEvent.touches[0].screenY-u+"px",left:parseInt(z.css("left"))+n.originalEvent.touches[0].screenX-s+"px"}),s=n.originalEvent.touches[0].screenX,u=n.originalEvent.touches[0].screenY),l&&(f=Math.sqrt((n.originalEvent.touches[0].screenX-n.originalEvent.touches[1].screenX)*(n.originalEvent.touches[0].screenX-n.originalEvent.touches[1].screenX)+(n.originalEvent.touches[0].screenY-n.originalEvent.touches[1].screenY)*(n.originalEvent.touches[0].screenY-n.originalEvent.touches[1].screenY))/v,z.css({width:B*f+"px",height:L*f+"px",top:(e(t).height()-L*f)/2+"px",left:(e(t).width()-B*f)/2+"px"}),c=!0)}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(n){if(!c){if(!m(n.originalEvent)||w.quitOnImgClick)return!0;Math.abs(N)>50?N<0?O():S():p?d(z,"0px",w.animationSpeed/1e3):z.animate({left:a+"px"},w.animationSpeed/2)}if(h&&(h=!1),l&&(l=!1,v=1,c&&f<=1)){var i=Math.abs(1-w.gutter/100);z.css({width:B*i+"px",height:L*i+"px",top:(1+w.offsetY/100)*(e(t).height()-L*i)/2,left:(e(t).width()-B*i)/2}),c=!1}})},w.animationSpeed+100)},Q=function(){if(!z.length)return!1;z.remove(),z=e()},W=function(t){if(j)return!1;j=!1,R=t,y(),e("body").append(g).addClass("imagelightbox-disable-select"),w.lockBody&&e("body").addClass("imagelightbox-scroll-lock"),g.trigger("start.ilb2"),H(0)},$=function(){if(g.trigger("quit.ilb2"),e("body").removeClass("imagelightbox-disable-select"),w.lockBody&&e("body").removeClass("imagelightbox-scroll-lock"),!z.length)return!1;z.animate({opacity:0},w.animationSpeed,function(){Q(),j=!1,D=e([]),g.remove().find("*").remove()})},A=function(t){function n(){t.filter(function(){return e(this).data("imagelightbox")===P}).filter(function(){return U(e(this))}).each(function(){D=D.add(e(this))})}t.on("click.ilb7",{set:P},function(t){t.preventDefault(),P=e(t.currentTarget).data("imagelightbox"),n(),D.length<1?$():W(e(this))})};return e(t).on("resize.ilb7",_),e(n).ready(function(){e(n).on("keydown.ilb7",function(e){[13].indexOf(e.which)>-1&&e.preventDefault()}),w.quitOnDocClick&&e(n).on(v?"touchend.ilb7":"click.ilb7",function(t){z.length&&!e(t.target).is(z)&&(t.preventDefault(),$())}),(w.lockBody||w.fullscreen&&x)&&e(n).on("keydown.ilb7",function(e){if(!z.length)return!0;[9,32,38,40].indexOf(e.which)>-1&&e.preventDefault(),[13].indexOf(e.which)>-1&&E()}),w.enableKeyboard&&e(n).on("keyup.ilb7",function(e){if(!z.length)return!0;e.preventDefault(),[27].indexOf(e.which)>-1&&w.quitOnEscKey&&$(),[37].indexOf(e.which)>-1?O():[39].indexOf(e.which)>-1&&S()})}),e(n).off("click",w.selector),A(e(this)),this.addToImageLightbox=function(e){A(e)},this.loadPreviousImage=function(){O()},this.loadNextImage=function(){S()},this.quitImageLightbox=function(){return $(),this},this.startImageLightbox=function(){e(this).trigger("click.ilb7")},this}}(jQuery,window,document);