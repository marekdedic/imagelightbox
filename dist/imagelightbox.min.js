!function(t){"object"==typeof module&&"object"==typeof module.exports?t(require("jquery"),window,document):t(jQuery,window,document)}(function(D,z,X){"use strict";var j=D("<div/>").attr("class","imagelightbox-loading").append(D("<div/>")),t=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),e=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),N=t.add(e),U=D("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),V=D("<button/>",{type:"button",class:"imagelightbox-close"}),K=D("<div/>",{class:"imagelightbox-overlay"}),Y=D("<a/>",{href:"#",class:"imagelightbox-navitem"}),_=D("<div/>",{class:"imagelightbox-nav"}),H=D("<div/>",{class:"imagelightbox-wrapper"}),W=D("body"),o=function(){var t=X.body||X.documentElement;return""===(t=t.style).WebkitTransition?"-webkit-":""===t.MozTransition?"-moz-":""===t.OTransition?"-o-":""===t.transition&&""},$=!1!==o(),B=function(t,e,i){var n={},a=o();n[a+"transform"]="translateX("+e+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s ease-in",t.css(n)},Q="ontouchstart"in z,A=z.navigator.pointerEnabled||z.navigator.msPointerEnabled,G=function(t){if(Q)return!0;if(!A||void 0===t||void 0===t.pointerType)return!1;if(void 0!==t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!==t.pointerType)return!0}else if("mouse"!==t.pointerType)return!0;return!1},J=!1!=!!(X.fullscreenEnabled||X.webkitFullscreenEnabled||X.mozFullScreenEnabled||X.msFullscreenEnabled),Z=!(!z.history||!history.pushState);D.fn.imageLightbox=function(t){var i="",c=D([]),s=D(),u=D([]),r=-1,l=D(this),d=D(),g=0,f=0,h=0,p=!1,n=0,b=D.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},t),m=function(){b.activity&&S(),b.arrows&&N.css("display","block")},a=function(t,e,i){var n=e+"="+i,a="?"+n;if(t){var o=new RegExp("([?&])"+e+"=[^&]*");a=null!==t.match(o)?t.replace(o,"$1"+n):t+"&"+n}return a},o=function(){if(Z&&b.history){var t=c[r].dataset.ilb2Id;t||(t=r);var e={imageLightboxIndex:t},i=c[r].dataset.imagelightbox;i&&(e.imageLightboxSet=i);var n=a(X.location.search,"imageLightboxIndex",t);i&&(n=a(n,"imageLightboxSet",i)),z.history.pushState(e,"",X.location.pathname+n)}},e=function(t,e){var i=t;if(i){var n=new RegExp("[?]"+e+"=[^&]*"),a=new RegExp("&"+e+"=[^&]*");i=(i=i.replace(n,"?")).replace(a,"")}return i},v=function(t){var e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(X.location.search);if(e&&e[2])return decodeURIComponent(e[2].replace(/\+/g," "))},x=function(){if(Z&&b.history){var t=v("imageLightboxIndex");if(t){var e=(c=l).filter('[data-ilb2-id="'+t+'"]');0<e.length?r=c.index(e):e=D(c[r=t]);var i=v("imageLightboxSet");!e[0]||i&&i!==e[0].dataset.imagelightbox||P(e,!0)}}},y=function(){if(--r<0){if(!0===b.quitOnEnd)return M(),!1;r=c.length-1}s=c.eq(r),o(),H.trigger("previous.ilb2",s),F(1)},w=function(){if(++r>=c.length){if(!0===b.quitOnEnd)return M(),!1;r=0}o(),s=c.eq(r),H.trigger("next.ilb2",s),F(-1)},E=function(){H.append(j)},S=function(){D(".imagelightbox-loading").remove()},q=function(){H.append(K)},I=function(){V.appendTo(H).on("click.ilb7",function(){return M(),!1})},k=function(){U.html("&nbsp;"),D(s).data("ilb2-caption")?U.html(D(s).data("ilb2-caption")):0<D(s).find("img").length&&U.html(D(s).find("img").attr("alt"))},O=function(){if(c.length){for(var t=0;t<c.length;t++)_.append(Y.clone());var e=_.children("a");e.eq(c.index(s)).addClass("active"),H.on("previous.ilb2 next.ilb2",function(){e.removeClass("active").eq(c.index(s)).addClass("active")}),H.append(_),_.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t=D(this);if(c.eq(t.index()).attr("href")!==D(".imagelightbox").attr("src")){var e=c.eq(t.index());e.length&&(n=c.index(s),s=e,F(t.index()<n?-1:1))}t.addClass("active").siblings().removeClass("active")})}},C=function(){H.append(N),N.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),D(this).hasClass("imagelightbox-arrow-left")?y():w(),!1})},T=function(){if(!d.length)return!0;var t=b.caption?U.outerHeight():0,a=D(z).width(),o=D(z).height()-t,r=Math.abs(1-b.gutter/100);function e(){if(a<g||o<f){var t=a/o<g/f?g/a:f/o;g/=t,f/=t}var e=f*r,i=g*r,n=(D(z).width()-i)/2;d.css({width:i+"px",height:e+"px",left:n+"px"})}if(void 0!==d.get(0).videoWidth)return g=d.get(0).videoWidth,f=d.get(0).videoHeight,void e();var i=new Image;i.src=d.attr("src"),i.onload=function(){g=i.width,f=i.height,e()}},F=function(l){if(p)return!1;if(d.length){var t={opacity:0};$?B(d,100*l-h+"px",b.animationSpeed/1e3):t.left=parseInt(d.css("left"))+100*l+"px",d.animate(t,b.animationSpeed,function(){L()}),h=0}p=!0,b.activity&&E(),b.caption&&k(),setTimeout(function(){var t,e,i=s.attr("href"),n=0,a=0,o=0;function r(){var t={opacity:1};if(d.appendTo(H),T(),d.css("opacity",0),$)B(d,-100*l+"px",0),setTimeout(function(){B(d,"0px",b.animationSpeed/1e3)},50);else{var e=parseInt(d.css("left"));t.left=e+"px",d.css("left",e-100*l+"px")}if(d.animate(t,b.animationSpeed,function(){p=!1,m()}),b.preloadNext){var i=c.eq(c.index(s)+1);i.length||(i=c.eq(0)),D("<img />").attr("src",i.attr("href"))}H.trigger("loaded.ilb2")}s.data("ilb2Video")?u.each(function(){this.i===s.data("ilb2VideoId")&&(t=this.l,e=this.e,this.a&&(!1===t&&e.attr("autoplay",this.a),!0===t&&e.get(0).play()))}):e=D("<img id='"+b.id+"' />").attr("src",i),d=e.on("load.ilb7",r).on("error.ilb7",function(){m()}).on(A?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(t){return t.preventDefault(),b.quitOnImgClick?(M(),!1):!!G(t.originalEvent)||void((t.pageX||t.originalEvent.pageX)-t.target.offsetLeft<g/2?y():w())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(t){if(!G(t.originalEvent)||b.quitOnImgClick)return!0;$&&(o=parseInt(d.css("left"))),n=t.originalEvent.pageX||t.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(t){if(!A&&"pointermove"===t.type||!G(t.originalEvent)||b.quitOnImgClick)return!0;t.preventDefault(),a=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,h=n-a,$?B(d,-h+"px",0):d.css("left",o-h+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(t){if(!G(t.originalEvent)||b.quitOnImgClick)return!0;50<Math.abs(h)?h<0?y():w():$?B(d,"0px",b.animationSpeed/1e3):d.animate({left:o+"px"},b.animationSpeed/2)}),!0===t&&r(),!1===t&&(d=d.on("loadedmetadata.ilb7",r))},b.animationSpeed+100)},L=function(){if(!d.length)return!1;d.remove(),d=D()},P=function(t,e){if(p)return!1;p=!1,s=t,r=c.index(s),e||o(),function(){b.arrows&&C(this),b.navigation&&O(),b.overlay&&q(),b.button&&I(),b.caption&&H.append(U)}(),W.append(H).addClass("imagelightbox-open"),H.trigger("start.ilb2",t),F(0)},M=function(t){if(r=-1,t||function(){if(Z&&b.history){var t=e(X.location.search,"imageLightboxIndex");t=e(t,"imageLightboxSet"),z.history.pushState({},"",X.location.pathname+t)}}(),H.trigger("quit.ilb2"),W.removeClass("imagelightbox-open"),!d.length)return!1;d.animate({opacity:0},b.animationSpeed,function(){L(),p=!1,c=D([]),H.remove().find("*").remove()})},R=function(e){e.each(function(){l=l.add(D(this))}),e.on("click.ilb7",{set:i},function(t){t.preventDefault(),i=D(t.currentTarget).data("imagelightbox"),e.filter(function(){return D(this).data("imagelightbox")===i}).filter(function(){return t=D(this),"a"===D(t).prop("tagName").toLowerCase()&&(new RegExp(".("+b.allowedTypes+")$","i").test(D(t).attr("href"))||D(t).data("ilb2Video"));var t}).each(function(){c=c.add(D(this))}),c.length<1?M():P(D(this))})};return D(z).on("resize.ilb7",T),Z&&b.history&&D(z).on("popstate",function(t){var e=t.originalEvent.state;if(e){var i=e.imageLightboxIndex;if(void 0!==i){var n=l.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var a=l.index(n);else n=D(l[a=i]);if(n[0]&&(!e.imageLightboxSet||e.imageLightboxSet===n[0].dataset.imagelightbox)){if(r<0)return c=l,void P(n,!0);var o=1;r<a&&(o=-1),s=n,r=a,F(o)}}else M(!0)}else M(!0)}),D(X).ready(function(){b.quitOnDocClick&&D(X).on(Q?"touchend.ilb7":"click.ilb7",function(t){d.length&&!D(t.target).is(d)&&(t.preventDefault(),M())}),b.fullscreen&&J&&D(X).on("keydown.ilb7",function(t){if(!d.length)return!0;var e;-1<[9,32,38,40].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault()),-1<[13].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),(e=X.getElementById(b.id).parentElement).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),X.exitFullscreen?X.exitFullscreen():X.mozCancelFullScreen?X.mozCancelFullScreen():X.webkitExitFullscreen&&X.webkitExitFullscreen())}),b.enableKeyboard&&D(X).on("keydown.ilb7",function(t){if(!d.length)return!0;-1<[27].indexOf(t.which)&&b.quitOnEscKey&&(t.stopPropagation(),t.preventDefault(),M()),-1<[37].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),y()),-1<[39].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),w())})}),D(X).off("click",b.selector),R(l),x(),l.each(function(){var t=D(this).data("ilb2Video");if(t){var e=D(this).data("ilb2Id");e||(e="a"+(65536*(1+Math.random())|0).toString(16)),D(this).data("ilb2VideoId",e);var n={e:D("<video id='"+b.id+"' preload='metadata'>"),i:e,l:!1,a:void 0};D.each(t,function(t,e){"autoplay"===t?n.a=e:"sources"!==t&&(n.e=n.e.attr(t,e))}),t.sources&&D.each(t.sources,function(t,e){var i=D("<source>");D.each(e,function(t,e){i=i.attr(t,e)}),n.e.append(i)}),n.e.on("loadedmetadata.ilb7",function(){n.l=!0}),u=u.add(n)}}),this.addToImageLightbox=function(t){R(t)},this.openHistory=function(){x()},this.loadPreviousImage=function(){y()},this.loadNextImage=function(){w()},this.quitImageLightbox=function(){return M(),this},this.startImageLightbox=function(t){t?t.trigger("click.ilb7"):D(this).trigger("click.ilb7")},this}});