!function(t){"object"==typeof module&&"object"==typeof module.exports?t(require("jquery"),window,document):t(jQuery,window,document)}(function(R,D,z){"use strict";var X=R("<div/>").attr("class","imagelightbox-loading").append(R("<div/>")),t=R("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),e=R("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),j=t.add(e),N=R("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),U=R("<button/>",{type:"button",class:"imagelightbox-close"}),V=R("<div/>",{class:"imagelightbox-overlay"}),K=R("<a/>",{href:"#",class:"imagelightbox-navitem"}),Y=R("<div/>",{class:"imagelightbox-nav"}),_=R("<div/>",{class:"imagelightbox-wrapper"}),H=R("body"),W=function(t,e,i){var n,a={},o=""===(n=(n=z.body||z.documentElement).style).WebkitTransition?"-webkit-":""===n.MozTransition?"-moz-":""===n.OTransition?"-o-":""===n.transition&&"";a[o+"transform"]="translateX("+e+") translateY(-50%)",a[o+"transition"]=o+"transform "+i+"s linear",t.css(a)},$="ontouchstart"in D,B=D.navigator.pointerEnabled||D.navigator.msPointerEnabled,Q=function(t){if($)return!0;if(!B||void 0===t||void 0===t.pointerType)return!1;if(void 0!==t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!==t.pointerType)return!0}else if("mouse"!==t.pointerType)return!0;return!1},A=!1!=!!(z.fullscreenEnabled||z.webkitFullscreenEnabled||z.mozFullScreenEnabled||z.msFullscreenEnabled),G=!(!D.history||!history.pushState);R.fn.imageLightbox=function(t){var i="",l=R([]),c=R(),u=R([]),r=-1,s=R(),g=0,d=0,h=0,f=!1,n=0,p=R.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},t),b=function(){p.activity&&E(),p.arrows&&j.css("display","block")},a=function(t,e,i){var n=e+"="+i,a="?"+n;if(t){var o=new RegExp("([?&])"+e+"=[^&]*");a=null!==t.match(o)?t.replace(o,"$1"+n):t+"&"+n}return a},o=function(){if(G&&p.history){var t=l[r].dataset.ilb2Id;t||(t=r);var e={imageLightboxIndex:t},i=l[r].dataset.imagelightbox;i&&(e.imageLightboxSet=i);var n=a(z.location.search,"imageLightboxIndex",t);i&&(n=a(n,"imageLightboxSet",i)),D.history.pushState(e,"",z.location.pathname+n)}},e=function(t,e){var i=t;if(i){var n=new RegExp("[?]"+e+"=[^&]*"),a=new RegExp("&"+e+"=[^&]*");i=(i=i.replace(n,"?")).replace(a,"")}return i},m=function(t){var e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(z.location.search);if(e&&e[2])return decodeURIComponent(e[2].replace(/\+/g," "))},v=function(){if(G&&p.history){var t=m("imageLightboxIndex");if(t){var e=l.filter('[data-ilb2-id="'+t+'"]');0<e.length?r=l.index(e):e=R(l[r=t]);var i=m("imageLightboxSet");!e[0]||i&&i!==e[0].dataset.imagelightbox||L(e,!0)}}},x=function(){if(--r<0){if(!0===p.quitOnEnd)return P(),!1;r=l.length-1}c=l.eq(r),o(),_.trigger("previous.ilb2",c),T(1)},y=function(){if(++r>=l.length){if(!0===p.quitOnEnd)return P(),!1;r=0}o(),c=l.eq(r),_.trigger("next.ilb2",c),T(-1)},w=function(){_.append(X)},E=function(){R(".imagelightbox-loading").remove()},q=function(){_.append(V)},S=function(){U.appendTo(_).on("click.ilb7",function(){return P(),!1})},k=function(){N.html("&nbsp;"),R(c).data("ilb2-caption")?N.html(R(c).data("ilb2-caption")):0<R(c).find("img").length&&N.html(R(c).find("img").attr("alt"))},I=function(){if(l.length){for(var t=0;t<l.length;t++)Y.append(K.clone());var e=Y.children("a");e.eq(l.index(c)).addClass("active"),_.on("previous.ilb2 next.ilb2",function(){e.removeClass("active").eq(l.index(c)).addClass("active")}),_.append(Y),Y.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t=R(this);if(l.eq(t.index()).attr("href")!==R(".imagelightbox").attr("src")){var e=l.eq(t.index());e.length&&(n=l.index(c),c=e,T(t.index()<n?-1:1))}t.addClass("active").siblings().removeClass("active")})}},O=function(){_.append(j),j.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),R(this).hasClass("imagelightbox-arrow-left")?x():y(),!1})},C=function(){if(!s.length)return!0;var t=p.caption?N.outerHeight():0,a=R(D).width(),o=R(D).height()-t,r=Math.abs(1-p.gutter/100);function e(){if(a<g||o<d){var t=a/o<g/d?g/a:d/o;g/=t,d/=t}var e=d*r,i=g*r,n=(R(D).width()-i)/2;s.css({width:i+"px",height:e+"px",left:n+"px"})}if(void 0!==s.get(0).videoWidth)return g=s.get(0).videoWidth,d=s.get(0).videoHeight,void e();var i=new Image;i.src=s.attr("src"),i.onload=function(){g=i.width,d=i.height,e()}},T=function(r){if(f)return!1;if(s.length){W(s,100*r-h+"px",p.animationSpeed/1e3),s.animate({opacity:0},p.animationSpeed,function(){F()}),h=0}f=!0,p.activity&&w(),p.caption&&k(),setTimeout(function(){var t,e,i=c.attr("href"),n=0,a=0;function o(){if(s.appendTo(_),C(),s.css("opacity",0),W(s,-100*r+"px",0),setTimeout(function(){W(s,"0px",p.animationSpeed/1e3)},50),s.animate({opacity:1},p.animationSpeed,function(){f=!1,b()}),p.preloadNext){var t=l.eq(l.index(c)+1);t.length||(t=l.eq(0)),R("<img />").attr("src",t.attr("href"))}_.trigger("loaded.ilb2")}c.data("ilb2Video")?u.each(function(){this.i===c.data("ilb2VideoId")&&(t=this.l,e=this.e,this.a&&(!1===t&&e.attr("autoplay",this.a),!0===t&&e.get(0).play()))}):e=R("<img id='"+p.id+"' />").attr("src",i),s=e.on("load.ilb7",o).on("error.ilb7",function(){b()}).on(B?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(t){return t.preventDefault(),p.quitOnImgClick?(P(),!1):!!Q(t.originalEvent)||void((t.pageX||t.originalEvent.pageX)-t.target.offsetLeft<g/2?x():y())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(t){if(!Q(t.originalEvent)||p.quitOnImgClick)return!0;n=t.originalEvent.pageX||t.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(t){if(!B&&"pointermove"===t.type||!Q(t.originalEvent)||p.quitOnImgClick)return!0;t.preventDefault(),a=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,W(s,-(h=n-a)+"px",0)}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(t){if(!Q(t.originalEvent)||p.quitOnImgClick)return!0;50<Math.abs(h)?h<0?x():y():W(s,"0px",p.animationSpeed/1e3)}),!0===t&&o(),!1===t&&(s=s.on("loadedmetadata.ilb7",o))},p.animationSpeed+100)},F=function(){if(!s.length)return!1;s.remove(),s=R()},L=function(t,e){if(f)return!1;f=!1,c=t,r=l.index(c),e||o(),function(){p.arrows&&O(this),p.navigation&&I(),p.overlay&&q(),p.button&&S(),p.caption&&_.append(N)}(),H.append(_).addClass("imagelightbox-open"),_.trigger("start.ilb2",t),T(0)},P=function(t){if(r=-1,t||function(){if(G&&p.history){var t=e(z.location.search,"imageLightboxIndex");t=e(t,"imageLightboxSet"),D.history.pushState({},"",z.location.pathname+t)}}(),_.trigger("quit.ilb2"),H.removeClass("imagelightbox-open"),!s.length)return!1;s.animate({opacity:0},p.animationSpeed,function(){F(),f=!1,_.remove().find("*").remove()})},M=function(e){e.each(function(){l=e.add(R(this))}),e.on("click.ilb7",{set:i},function(t){t.preventDefault(),i=R(t.currentTarget).data("imagelightbox"),e.filter(function(){return R(this).data("imagelightbox")===i}).filter(function(){return t=R(this),"a"===R(t).prop("tagName").toLowerCase()&&(new RegExp(".("+p.allowedTypes+")$","i").test(R(t).attr("href"))||R(t).data("ilb2Video"));var t}).each(function(){l=l.add(R(this))}),l.length<1?P():L(R(this))})};return R(D).on("resize.ilb7",C),G&&p.history&&R(D).on("popstate",function(t){var e=t.originalEvent.state;if(e){var i=e.imageLightboxIndex;if(void 0!==i){var n=l.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var a=l.index(n);else n=R(l[a=i]);if(n[0]&&(!e.imageLightboxSet||e.imageLightboxSet===n[0].dataset.imagelightbox))if(r<0)L(n,!0);else{var o=1;r<a&&(o=-1),c=n,r=a,T(o)}}else P(!0)}else P(!0)}),R(z).ready(function(){p.quitOnDocClick&&R(z).on($?"touchend.ilb7":"click.ilb7",function(t){s.length&&!R(t.target).is(s)&&(t.preventDefault(),P())}),p.fullscreen&&A&&R(z).on("keydown.ilb7",function(t){if(!s.length)return!0;var e;-1<[9,32,38,40].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault()),-1<[13].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),(e=z.getElementById(p.id).parentElement).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),z.exitFullscreen?z.exitFullscreen():z.mozCancelFullScreen?z.mozCancelFullScreen():z.webkitExitFullscreen&&z.webkitExitFullscreen())}),p.enableKeyboard&&R(z).on("keydown.ilb7",function(t){if(!s.length)return!0;-1<[27].indexOf(t.which)&&p.quitOnEscKey&&(t.stopPropagation(),t.preventDefault(),P()),-1<[37].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),x()),-1<[39].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),y())})}),R(z).off("click",p.selector),M(R(this)),v(),l.each(function(){var t=R(this).data("ilb2Video");if(t){var e=R(this).data("ilb2Id");e||(e="a"+(65536*(1+Math.random())|0).toString(16)),R(this).data("ilb2VideoId",e);var n={e:R("<video id='"+p.id+"' preload='metadata'>"),i:e,l:!1,a:void 0};R.each(t,function(t,e){"autoplay"===t?n.a=e:"sources"!==t&&(n.e=n.e.attr(t,e))}),t.sources&&R.each(t.sources,function(t,e){var i=R("<source>");R.each(e,function(t,e){i=i.attr(t,e)}),n.e.append(i)}),n.e.on("loadedmetadata.ilb7",function(){n.l=!0}),u=u.add(n)}}),this.addToImageLightbox=function(t){M(t)},this.openHistory=function(){v()},this.loadPreviousImage=function(){x()},this.loadNextImage=function(){y()},this.quitImageLightbox=function(){return P(),this},this.startImageLightbox=function(t){t?t.trigger("click.ilb7"):R(this).trigger("click.ilb7")},this}});