!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(D,M,z){"use strict";var X=D("<div/>").attr("class","imagelightbox-loading").append(D("<div/>")),e=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),j=e.add(t),N=D("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),U=D("<button/>",{type:"button",class:"imagelightbox-close"}),K=D("<div/>",{class:"imagelightbox-overlay"}),Y=D("<a/>",{href:"#",class:"imagelightbox-navitem"}),_=D("<div/>",{class:"imagelightbox-nav"}),V=D("<div/>",{class:"imagelightbox-wrapper"}),W=D("body"),o=function(){var e=z.body||z.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},$=!1!==o(),H=function(e,t,i){var n={},a=o();n[a+"transform"]="translateX("+t+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s linear",e.css(n)},B="ontouchstart"in M,Q=M.navigator.pointerEnabled||M.navigator.msPointerEnabled,A=function(e){if(B)return!0;if(!Q||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},G=!1!=!!(z.fullscreenEnabled||z.webkitFullscreenEnabled||z.mozFullScreenEnabled||z.msFullscreenEnabled),J=!(!M.history||!history.pushState);D.fn.imageLightbox=function(e){var i="",c=D([]),u=D(),s=D([]),r=-1,l=D(this),g=D(),d=0,f=0,h=0,p=!1,n=0,b=D.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),m=function(){b.activity&&E(),b.arrows&&j.css("display","block")},a=function(e,t,i){var n=t+"="+i,a="?"+n;if(e){var o=new RegExp("([?&])"+t+"=[^&]*");a=null!==e.match(o)?e.replace(o,"$1"+n):e+"&"+n}return a},o=function(){if(J&&b.history){var e=c[r].dataset.ilb2Id;e||(e=r);var t={imageLightboxIndex:e},i=c[r].dataset.imagelightbox;i&&(t.imageLightboxSet=i);var n=a(z.location.search,"imageLightboxIndex",e);i&&(n=a(n,"imageLightboxSet",i)),M.history.pushState(t,"",z.location.pathname+n)}},t=function(e,t){var i=e;if(i){var n=new RegExp("[?]"+t+"=[^&]*"),a=new RegExp("&"+t+"=[^&]*");i=(i=i.replace(n,"?")).replace(a,"")}return i},v=function(e){var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(z.location.search);if(t&&t[2])return decodeURIComponent(t[2].replace(/\+/g," "))},x=function(){if(--r<0){if(!0===b.quitOnEnd)return P(),!1;r=c.length-1}u=c.eq(r),o(),V.trigger("previous.ilb2"),T(1)},y=function(){if(++r>=c.length){if(!0===b.quitOnEnd)return P(),!1;r=0}o(),u=c.eq(r),V.trigger("next.ilb2"),T(-1)},w=function(){V.append(X)},E=function(){D(".imagelightbox-loading").remove()},q=function(){V.append(K)},S=function(){U.appendTo(V).on("click.ilb7",function(){return P(),!1})},k=function(){N.html("&nbsp;"),D(u).data("ilb2-caption")?N.html(D(u).data("ilb2-caption")):0<D(u).find("img").length&&N.html(D(u).find("img").attr("alt"))},I=function(){if(c.length){for(var e=0;e<c.length;e++)_.append(Y.clone());var t=_.children("a");t.eq(c.index(u)).addClass("active"),V.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(c.index(u)).addClass("active")}),V.append(_),_.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=D(this);if(c.eq(e.index()).attr("href")!==D(".imagelightbox").attr("src")){var t=c.eq(e.index());t.length&&(n=c.index(u),u=t,T(e.index()<n?-1:1))}e.addClass("active").siblings().removeClass("active")})}},O=function(){V.append(j),j.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),D(this).hasClass("imagelightbox-arrow-left")?x():y(),!1})},C=function(){if(!g.length)return!0;var e=b.caption?N.outerHeight():0,a=D(M).width(),o=D(M).height()-e,r=Math.abs(1-b.gutter/100);function t(){if(a<d||o<f){var e=a/o<d/f?d/a:f/o;d/=e,f/=e}var t=f*r,i=d*r,n=(D(M).width()-i)/2;g.css({width:i+"px",height:t+"px",left:n+"px"})}if(void 0!==g.get(0).videoWidth)return d=g.get(0).videoWidth,f=g.get(0).videoHeight,void t();var i=new Image;i.src=g.attr("src"),i.onload=function(){d=i.width,f=i.height,t()}},T=function(l){if(p)return!1;if(g.length){var e={opacity:0};$?H(g,100*l-h+"px",b.animationSpeed/1e3):e.left=parseInt(g.css("left"))+100*l+"px",g.animate(e,b.animationSpeed,function(){F()}),h=0}p=!0,b.activity&&w(),b.caption&&k(),setTimeout(function(){var e,t,i=u.attr("href"),n=0,a=0,o=0;function r(){var e={opacity:1};if(g.appendTo(V),C(),g.css("opacity",0),$)H(g,-100*l+"px",0),setTimeout(function(){H(g,"0px",b.animationSpeed/1e3)},50);else{var t=parseInt(g.css("left"));e.left=t+"px",g.css("left",t-100*l+"px")}if(g.animate(e,b.animationSpeed,function(){p=!1,m()}),b.preloadNext){var i=c.eq(c.index(u)+1);i.length||(i=c.eq(0)),D("<img />").attr("src",i.attr("href"))}V.trigger("loaded.ilb2")}u.data("ilb2Video")?s.each(function(){this.e.attr("id")===b.id&&(e=this.l,t=this.e,this.a&&(!1===e&&t.attr("autoplay",this.a),!0===e&&t.get(0).play()))}):t=D("<img id='"+b.id+"' />").attr("src",i),g=t.on("load.ilb7",r).on("error.ilb7",function(){m()}).on(Q?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),b.quitOnImgClick?(P(),!1):!!A(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<d/2?x():y())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!A(e.originalEvent)||b.quitOnImgClick)return!0;$&&(o=parseInt(g.css("left"))),n=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!Q&&"pointermove"===e.type||!A(e.originalEvent)||b.quitOnImgClick)return!0;e.preventDefault(),a=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,h=n-a,$?H(g,-h+"px",0):g.css("left",o-h+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!A(e.originalEvent)||b.quitOnImgClick)return!0;50<Math.abs(h)?h<0?x():y():$?H(g,"0px",b.animationSpeed/1e3):g.animate({left:o+"px"},b.animationSpeed/2)}),!0===e&&r(),!1===e&&(g=g.on("loadedmetadata.ilb7",r))},b.animationSpeed+100)},F=function(){if(!g.length)return!1;g.remove(),g=D()},L=function(e,t){if(p)return!1;p=!1,u=e,r=c.index(u),t||o(),function(){b.arrows&&O(this),b.navigation&&I(),b.overlay&&q(),b.button&&S(),b.caption&&V.append(N)}(),W.append(V).addClass("imagelightbox-open"),V.trigger("start.ilb2"),T(0)},P=function(e){if(r=-1,e||function(){if(J&&b.history){var e=t(z.location.search,"imageLightboxIndex");e=t(e,"imageLightboxSet"),M.history.pushState({},"",z.location.pathname+e)}}(),V.trigger("quit.ilb2"),W.removeClass("imagelightbox-open"),!g.length)return!1;g.animate({opacity:0},b.animationSpeed,function(){F(),p=!1,c=D([]),V.remove().find("*").remove()})},R=function(t){t.on("click.ilb7",{set:i},function(e){e.preventDefault(),i=D(e.currentTarget).data("imagelightbox"),t.filter(function(){return D(this).data("imagelightbox")===i}).filter(function(){return e=D(this),"a"===D(e).prop("tagName").toLowerCase()&&(new RegExp(".("+b.allowedTypes+")$","i").test(D(e).attr("href"))||D(e).data("ilb2Video"));var e}).each(function(){c=c.add(D(this))}),c.length<1?P():L(D(this))})};return D(M).on("resize.ilb7",C),J&&b.history&&D(M).on("popstate",function(e){var t=e.originalEvent.state;if(t){var i=t.imageLightboxIndex;if(void 0!==i){var n=l.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var a=l.index(n);else n=D(l[a=i]);if(n[0]&&(!t.imageLightboxSet||t.imageLightboxSet===n[0].dataset.imagelightbox)){if(r<0)return c=l,void L(n,!0);var o=1;r<a&&(o=-1),u=n,r=a,T(o)}}else P(!0)}else P(!0)}),D(z).ready(function(){b.quitOnDocClick&&D(z).on(B?"touchend.ilb7":"click.ilb7",function(e){g.length&&!D(e.target).is(g)&&(e.preventDefault(),P())}),b.fullscreen&&G&&D(z).on("keydown.ilb7",function(e){if(!g.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=z.getElementById(b.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),z.exitFullscreen?z.exitFullscreen():z.mozCancelFullScreen?z.mozCancelFullScreen():z.webkitExitFullscreen&&z.webkitExitFullscreen())}),b.enableKeyboard&&D(z).on("keydown.ilb7",function(e){if(!g.length)return!0;-1<[27].indexOf(e.which)&&b.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),P()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),x()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),y())})}),D(z).off("click",b.selector),R(l),function(){if(J&&b.history){var e=v("imageLightboxIndex");if(e){var t=(c=l).filter('[data-ilb2-id="'+e+'"]');0<t.length?r=c.index(t):t=D(c[r=e]);var i=v("imageLightboxSet");!t[0]||i&&i!==t[0].dataset.imagelightbox||L(t,!0)}}}(),l.each(function(){var e=D(this).data("ilb2Video");if(e){var n={e:D("<video id='"+b.id+"' preload='metadata'>"),l:!1,a:void 0};D.each(e,function(e,t){"autoplay"===e?n.a=t:"sources"!==e&&(n.e=n.e.attr(e,t))}),e.sources&&D.each(e.sources,function(e,t){var i=D("<source>");D.each(t,function(e,t){i=i.attr(e,t)}),n.e.append(i)}),n.e.on("loadedmetadata.ilb7",function(){n.l=!0}),s=s.add(n)}}),this.addToImageLightbox=function(e){R(e)},this.loadPreviousImage=function(){x()},this.loadNextImage=function(){y()},this.quitImageLightbox=function(){return P(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):D(this).trigger("click.ilb7")},this}});